#ifndef _LEGENDRE_HPP_
#define _LEGENDRE_HPP_
#include <array>
#include <cassert>

namespace legendre
{
constexpr inline  std::array<std::array<double,2>,1> order1{ std::array<double,2>{0., 2.} };
constexpr inline  std::array<std::array<double,2>,2> order2{ std::array<double,2>{-0.577350269189625, 1.},
                                                                                 {+0.577350269189625, 1.}};
constexpr inline  std::array<std::array<double,2>,3> order3{ std::array<double,2>{-0.774596669241483, 5./9.},
                                                                                 {0.0, 8./9.},
                                                                                 {0.7745966692414833, 5./9.}
                                                      };
constexpr inline  std::array<std::array<double,2>,4> order4{ std::array<double,2>{-0.86113631159405257, 0.347854845137453},
                                                                                 {-0.33998104358485626, 0.652145154862546},
                                                                                 { 0.33998104358485626, 0.652145154862546},
                                                                                 { 0.86113631159405257, 0.347854845137453} };
constexpr inline  std::array<std::array<double,2>,5> order5{ std::array<double,2>{-0.906179845938663992, 0.2369268850561890},
                                                                                 {-0.538469310105683091, 0.4786286704993664},
                                                                                 { 0.0                 , 0.568888888888888888},
                                                                                 { 0.538469310105683091, 0.478628670499366468},
                                                                                 { 0.906179845938663992, 0.23692688505618908} };
constexpr inline  std::array<std::array<double,2>,6> order6{ std::array<double,2>{-0.932469514203152027, 0.1713244923791703},
                                                                                 {-0.66120938646626451 , 0.3607615730481386},
                                                                                 {-0.23861918608319690 , 0.46791393457269104},
                                                                                 { 0.23861918608319690 , 0.46791393457269104},
                                                                                 { 0.66120938646626451 , 0.36076157304813860},
                                                                                 { 0.93246951420315202 , 0.1713244923791703} };
constexpr inline  std::array<std::array<double,2>,7> order7{ std::array<double,2>{-0.94910791234275852 , 0.1294849661688696},
                                                                                 {-0.74153118559939443 , 0.2797053914892766},
                                                                                 {-0.40584515137739716 , 0.3818300505051189},
                                                                                 { 0.0                 , 0.4179591836734693},
                                                                                 { 0.40584515137739716 , 0.3818300505051189},
                                                                                 { 0.74153118559939443 , 0.2797053914892766},
                                                                                 { 0.94910791234275852 , 0.1294849661688696} };
constexpr inline  std::array<std::array<double,2>,8> order8{ std::array<double,2>{-0.960289856497536231, 0.10122853629037625},
                                                                                 {-0.796666477413626739, 0.22238103445337447},
                                                                                 {-0.525532409916328985, 0.31370664587788728},
                                                                                 {-0.183434642495649804, 0.36268378337836198},
                                                                                 { 0.183434642495649804, 0.36268378337836198},
                                                                                 { 0.525532409916328985, 0.31370664587788728},
                                                                                 { 0.796666477413626739, 0.22238103445337447},
                                                                                 { 0.960289856497536231, 0.10122853629037625} };
constexpr inline  std::array<std::array<double,2>,9> order9{ std::array<double,2>{-0.968160239507626089, 0.08127438836157441},
                                                                                 {-0.836031107326635794, 0.18064816069485740},
                                                                                 {-0.613371432700590397, 0.26061069640293546},
                                                                                 {-0.324253423403808929, 0.31234707704000284},
                                                                                 { 0.0                 , 0.33023935500125976},
                                                                                 { 0.324253423403808929, 0.31234707704000284},
                                                                                 { 0.613371432700590397, 0.26061069640293546},
                                                                                 { 0.836031107326635794, 0.18064816069485740},
                                                                                 { 0.968160239507626089, 0.08127438836157441} };
constexpr inline  std::array<std::array<double,2>,10> order10{std::array<double,2>{-0.973906528517171720,0.06667134430868813},
                                                                                  {-0.865063366688984510,0.14945134915058059},
                                                                                  {-0.679409568299024406,0.21908636251598204},
                                                                                  {-0.433395394129247290,0.26926671930999635},
                                                                                  {-0.148874338981631210,0.29552422471475287},
                                                                                  { 0.148874338981631210,0.29552422471475287},
                                                                                  { 0.433395394129247290,0.26926671930999635},
                                                                                  { 0.679409568299024406,0.21908636251598204},
                                                                                  { 0.865063366688984510,0.14945134915058059},
                                                                                  { 0.973906528517171720,0.06667134430868813} };
constexpr inline  std::array<std::array<double,2>,11> order11{std::array<double,2>{-0.97822865814605699 ,0.0556685671161736 },
                                                                                  {-0.88706259976809529 ,0.1255803694649046},
                                                                                  {-0.73015200557404932 ,0.1862902109277342},
                                                                                  {-0.51909612920681181 ,0.2331937645919904},
                                                                                  {-0.26954315595234497 ,0.2628045445102466},
                                                                                  { 0.0                 ,0.2729250867779006},
                                                                                  { 0.26954315595234497 ,0.2628045445102466},
                                                                                  { 0.51909612920681181 ,0.2331937645919904},
                                                                                  { 0.73015200557404932 ,0.18629021092773425},
                                                                                  { 0.88706259976809529 ,0.1255803694649046},
                                                                                  { 0.97822865814605699 ,0.0556685671161736} };
constexpr inline  std::array<std::array<double,2>,12> order12{std::array<double,2>{-0.9815606342467192  ,0.04717533638651182},
                                                                                  {-0.9041172563704748  ,0.10693932599531843},
                                                                                  {-0.7699026741943046  ,0.16007832854334622},
                                                                                  {-0.5873179542866174  ,0.20316742672306592},
                                                                                  {-0.3678314989981801  ,0.23349253653835480},
                                                                                  {-0.1252334085114689  ,0.24914704581340278},
                                                                                  { 0.1252334085114689  ,0.24914704581340278},
                                                                                  { 0.3678314989981801  ,0.23349253653835480},
                                                                                  { 0.5873179542866174  ,0.20316742672306592},
                                                                                  { 0.7699026741943046  ,0.16007832854334622},
                                                                                  { 0.9041172563704748  ,0.10693932599531843},
                                                                                  { 0.9815606342467192  ,0.04717533638651182}
                                                                };
constexpr inline std::array<std::array<double,2>,13> order13{std::array<double,2>{-0.9841830547185881,0.040484004765315},
                                                                                 {-0.9175983992229779,0.092121499837728},
                                                                                 {-0.8015780907333099,0.138873510219787},
                                                                                 {-0.6423493394403402,0.178145980761945},
                                                                                 {-0.4484927510364468,0.207816047536888},
                                                                                 {-0.2304583159551347,0.226283180262897},
                                                                                 { 0.0               ,0.232551553230873},
                                                                                 { 0.2304583159551347,0.226283180262897},
                                                                                 { 0.4484927510364468,0.207816047536888},
                                                                                 { 0.6423493394403402,0.178145980761945},
                                                                                 { 0.8015780907333099,0.138873510219787},
                                                                                 { 0.9175983992229779,0.092121499837728},
                                                                                 { 0.9841830547185881,0.040484004765315}
                                                            };
constexpr inline std::array<std::array<double,2>,14> order14{std::array<double,2>{-0.9862838086968123,0.03511946033175}, 
                                                                                 {-0.9284348836635735,0.08015808715976},
                                                                                 {-0.8272013150697649,0.12151857068790},
                                                                                 {-0.6872929048116854,0.15720316715819},
                                                                                 {-0.5152486363581540,0.18553839747793},
                                                                                 {-0.3191123689278897,0.20519846372129},
                                                                                 {-0.1080549487073436,0.21526385346315},
                                                                                 { 0.1080549487073436,0.21526385346315},
                                                                                 { 0.3191123689278897,0.20519846372129},
                                                                                 { 0.5152486363581540,0.18553839747793},
                                                                                 { 0.6872929048116854,0.15720316715819},
                                                                                 { 0.8272013150697649,0.12151857068790},
                                                                                 { 0.9284348836635735,0.08015808715976},
                                                                                 { 0.9862838086968123,0.03511946033175}
                                                            };
constexpr inline std::array<std::array<double,2>,15> order15{std::array<double,2>{-0.9879925180204854,0.03075324199611727},
                                                                                 {-0.9372733924007059,0.07036604748810812},
                                                                                 {-0.8482065834104272,0.1071592204671719},
                                                                                 {-0.7244177313601700,0.1395706779261543},
                                                                                 {-0.5709721726085388,0.1662692058169939},
                                                                                 {-0.3941513470775634,0.1861610000155622},
                                                                                 {-0.2011940939974345,0.1984314853271116},
                                                                                 { 0.0               ,0.2025782419255613},
                                                                                 { 0.2011940939974345,0.1984314853271116},
                                                                                 { 0.3941513470775634,0.1861610000155622},
                                                                                 { 0.5709721726085388,0.1662692058169939},
                                                                                 { 0.7244177313601700,0.1395706779261543},
                                                                                 { 0.8482065834104272,0.1071592204671719},
                                                                                 { 0.9372733924007059,0.07036604748810812},
                                                                                 { 0.9879925180204854,0.03075324199611727}
                                                            };
constexpr inline std::array<std::array<double,2>,16> order16{std::array<double,2>{-0.989400934991649932,0.02715245941175409},
                                                                                 {-0.944575023073232576,0.06225352393864789},
                                                                                 {-0.865631202387831743,0.09515851168249278},
                                                                                 {-0.755404408355003033,0.12462897125553387},
                                                                                 {-0.617876244402643748,0.14959598881657673},
                                                                                 {-0.458016777657227386,0.16915651939500253},
                                                                                 {-0.281603550779258913,0.18260341504492358},
                                                                                 {-0.095012509837637440,0.18945061045506849},
                                                                                 { 0.095012509837637440,0.18945061045506849},
                                                                                 { 0.281603550779258913,0.18260341504492358},
                                                                                 { 0.458016777657227386,0.16915651939500253},
                                                                                 { 0.617876244402643748,0.14959598881657673},
                                                                                 { 0.755404408355003033,0.12462897125553387},
                                                                                 { 0.865631202387831743,0.09515851168249278},
                                                                                 { 0.944575023073232576,0.06225352393864789},
                                                                                 { 0.989400934991649932,0.02715245941175409}
                                                            };
constexpr inline std::array<std::array<double,2>,20> order20{std::array<double,2>{-0.9931285991850949,0.01761400713915212},
                                                                                 {-0.9639719272779138,0.04060142980038694},
                                                                                 {-0.9122344282513259,0.06267204833410906},
                                                                                 {-0.8391169718222188,0.08327674157670475},
                                                                                 {-0.7463319064601508,0.1019301198172404},
                                                                                 {-0.6360536807265150,0.1181945319615184},
                                                                                 {-0.5108670019508271,0.1316886384491766},
                                                                                 {-0.3737060887154196,0.1420961093183821},
                                                                                 {-0.2277858511416451,0.1491729864726037},
                                                                                 {-0.0765265211334973,0.1527533871307259},
                                                                                 { 0.0765265211334973,0.1527533871307259},
                                                                                 { 0.2277858511416451,0.1491729864726037},
                                                                                 { 0.3737060887154196,0.1420961093183821},
                                                                                 { 0.5108670019508271,0.1316886384491766},
                                                                                 { 0.6360536807265150,0.1181945319615184},
                                                                                 { 0.7463319064601508,0.1019301198172404},
                                                                                 { 0.8391169718222188,0.08327674157670475},
                                                                                 { 0.9122344282513259,0.06267204833410906},
                                                                                 { 0.9639719272779138,0.04060142980038694},
                                                                                 { 0.9931285991850949,0.01761400713915212}
                                                                };
constexpr inline std::array<std::array<double,2>,32> order32{std::array<double,2>{-0.997263861849482,0.0070186100094701},
                                                                                 {-0.985611511545268,0.0162743947309057},
                                                                                 {-0.964762255587506,0.0253920653092621},
                                                                                 {-0.934906075937740,0.0342738629130214},
                                                                                 {-0.896321155766052,0.0428358980222267},
                                                                                 {-0.849367613732570,0.0509980592623762},
                                                                                 {-0.794483795967942,0.0586840934785355},
                                                                                 {-0.732182118740290,0.0658222227763618},
                                                                                 {-0.663044266930215,0.0723457941088485},
                                                                                 {-0.587715757240762,0.0781938957870703},
                                                                                 {-0.506899908932229,0.0833119242269468},
                                                                                 {-0.421351276130635,0.0876520930044038},
                                                                                 {-0.331868602282128,0.0911738786957639},
                                                                                 {-0.239287362252137,0.0938443990808046},
                                                                                 {-0.144471961582796,0.0956387200792749},
                                                                                 {-0.0483076656877383,0.0965400885147278},
                                                                                 { 0.0483076656877383,0.0965400885147278},
                                                                                 { 0.144471961582796,0.0956387200792749},
                                                                                 { 0.239287362252137,0.0938443990808046},
                                                                                 { 0.331868602282128,0.0911738786957639},
                                                                                 { 0.421351276130635,0.0876520930044038},
                                                                                 { 0.506899908932229,0.0833119242269468},
                                                                                 { 0.587715757240762,0.0781938957870703},
                                                                                 { 0.663044266930215,0.0723457941088485},
                                                                                 { 0.732182118740290,0.0658222227763618},
                                                                                 { 0.794483795967942,0.0586840934785355},
                                                                                 { 0.849367613732570,0.0509980592623762},
                                                                                 { 0.896321155766052,0.0428358980222267},
                                                                                 { 0.934906075937740,0.0342738629130214},
                                                                                 { 0.964762255587506,0.0253920653092621},
                                                                                 { 0.985611511545268,0.0162743947309057},
                                                                                 { 0.997263861849482,0.0070186100094701}
                                                                };
constexpr inline std::array<std::array<double,2>,64> order64{std::array<double,2>{-0.999305041735772,0.00178328072169643},
                                                                                 {-0.996340116771955,0.00414703326056247},
                                                                                 {-0.991013371476744,0.00650445796897836},
                                                                                 {-0.983336253884626,0.00884675982636395},
                                                                                 {-0.973326827789911,0.0111681394601311},
                                                                                 {-0.961008799652054,0.0134630478967186},
                                                                                 {-0.946411374858403,0.0157260304760247},
                                                                                 {-0.929569172131940,0.0179517157756973},
                                                                                 {-0.910522137078503,0.0201348231535302},
                                                                                 {-0.889315445995114,0.0222701738083833},
                                                                                 {-0.865999398154093,0.0243527025687109},
                                                                                 {-0.840629296252580,0.0263774697150547},
                                                                                 {-0.813265315122798,0.0283396726142595},
                                                                                 {-0.783972358943341,0.0302346570724025},
                                                                                 {-0.752819907260532,0.0320579283548516},
                                                                                 {-0.719881850171611,0.0338051618371416},
                                                                                 {-0.685236313054233,0.0354722132568824},
                                                                                 {-0.648965471254657,0.0370551285402400},
                                                                                 {-0.611155355172393,0.0385501531786156},
                                                                                 {-0.571895646202634,0.0399537411327203},
                                                                                 {-0.531279464019895,0.0412625632426235},
                                                                                 {-0.489403145707053,0.0424735151236536},
                                                                                 {-0.446366017253464,0.0435837245293235},
                                                                                 {-0.402270157963992,0.0445905581637566},
                                                                                 {-0.357220158337668,0.0454916279274181},
                                                                                 {-0.311322871990211,0.0462847965813144},
                                                                                 {-0.264687162208767,0.0469681828162100},
                                                                                 {-0.217423643740007,0.0475401657148303},
                                                                                 {-0.169644420423993,0.0479993885964583},
                                                                                 {-0.121462819296121,0.0483447622348030},
                                                                                 {-0.072993121787799,0.0485754674415034},
                                                                                 {-0.0243502926634244,0.0486909570091397},
                                                                                 { 0.0243502926634244,0.0486909570091397},
                                                                                 { 0.072993121787799,0.0485754674415034},
                                                                                 { 0.121462819296121,0.0483447622348030},
                                                                                 { 0.169644420423993,0.0479993885964583},
                                                                                 { 0.217423643740007,0.0475401657148303},
                                                                                 { 0.264687162208767,0.0469681828162100},
                                                                                 { 0.311322871990211,0.0462847965813144},
                                                                                 { 0.357220158337668,0.0454916279274181},
                                                                                 { 0.402270157963992,0.0445905581637566},
                                                                                 { 0.446366017253464,0.0435837245293235},
                                                                                 { 0.489403145707053,0.0424735151236536},
                                                                                 { 0.531279464019895,0.0412625632426235},
                                                                                 { 0.571895646202634,0.0399537411327203},
                                                                                 { 0.611155355172393,0.0385501531786156},
                                                                                 { 0.648965471254657,0.0370551285402400},
                                                                                 { 0.685236313054233,0.0354722132568824},
                                                                                 { 0.719881850171611,0.0338051618371416},
                                                                                 { 0.752819907260532,0.0320579283548516},
                                                                                 { 0.783972358943341,0.0302346570724025},
                                                                                 { 0.813265315122798,0.0283396726142595},
                                                                                 { 0.840629296252580,0.0263774697150547},
                                                                                 { 0.865999398154093,0.0243527025687109},
                                                                                 { 0.889315445995114,0.0222701738083833},
                                                                                 { 0.910522137078503,0.0201348231535302},
                                                                                 { 0.929569172131940,0.0179517157756973},
                                                                                 { 0.946411374858403,0.0157260304760247},
                                                                                 { 0.961008799652054,0.0134630478967186},
                                                                                 { 0.973326827789911,0.0111681394601311},
                                                                                 { 0.983336253884626,0.00884675982636395},
                                                                                 { 0.991013371476744,0.00650445796897836},
                                                                                 { 0.996340116771955,0.00414703326056247},
                                                                                 { 0.999305041735772,0.00178328072169643}
                                                };
}

template<int order> constexpr auto get_quadrature()
{
    using namespace legendre;
    if constexpr (order == 1)
    {
        return order1;
    }
    else if constexpr (order == 2)
    {
        return order2;
    }
    else if constexpr (order == 3)
    {
        return order3;
    }
    else if constexpr (order == 4)
    {
        return order4;
    }
    else if constexpr (order == 5)
    {
        return order5;
    }
    else if constexpr (order == 6)
    {
        return order6;
    }
    else if constexpr (order == 7)
    {
        return order7;
    }
    else if constexpr (order == 8)
    {
        return order8;
    }
    else if constexpr (order == 9)
    {
        return order9;
    }
    else if constexpr (order == 10)
    {
        return order10;
    }
    else if constexpr (order == 11)
    {
        return order11;
    }
    else if constexpr (order == 12)
    {
        return order12;
    }
    else if constexpr (order == 13)
    {
        return order13;
    }
    else if constexpr (order == 14)
    {
        return order14;
    }
    else if constexpr (order == 15)
    {
        return order15;
    }
    else if constexpr (order == 16)
    {
        return order16;
    }
    else if constexpr (order == 20)
    {
        return order20;
    }
    else if constexpr (order == 32)
    {
        return order32;
    }
    else if constexpr (order == 64)
    {
        return order64;
    }
    else
    {
        assert(false && "Ordre d'intégration non mise en oeuvre !");
    }
}

#endif
